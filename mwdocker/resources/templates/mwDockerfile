#
# This dockerfile was generated by pymediawikidocker
#
FROM mediawiki:{{mwVersion}}

MAINTAINER Wolfgang Fahl <wf@bitplan.com>

# install some more utilities
RUN apt-get -y update && \
    apt-get -y --no-install-recommends --fix-missing install \
    mariadb-client \
    inetutils-ping \
    vim \
    unzip \
    zip &&\
    rm -rf /var/lib/apt/lists/*

#  openssh-server \
#  dialog \
#  imagemagick \
#  graphviz \
#  libjpeg62-turbo-dev \
#  libfreetype6-dev \
#  libpng-dev \
#  libzip-dev \
#  docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ && \
#  docker-php-ext-install gd

# copy the LocalSettings
COPY LocalSettings.php /var/www/html

# copy phpinfo.php
COPY phpinfo.php /var/www/html

# copy the SQL dump
COPY wiki.sql /tmp

# copy the initdb.sh script
COPY initdb.sh /tmp

# make the initdb.sh script executable
RUN chmod +x /tmp/initdb.sh

# restore the mediawiki initial database backup
# can not do this before SQL server is up see https://docs.docker.com/compose/startup-order/
# RUN /tmp/initdb.sh

